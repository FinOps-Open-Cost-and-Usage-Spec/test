name: Auto-Pin Status Update

on:
  issue_comment:
    types: [created]

jobs:
  pin-status:
    if: |
      startsWith(github.event.comment.body, '## ðŸ”„ Status Update') && 
      github.event.issue.pull_request == null
    
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: Pin the Status Update
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          COMMENT_ID: ${{ github.event.comment.id }}
        run: |
          # We use the 'raw' API call to hit the pinning endpoint directly
          gh api \
            --method PUT \
            -H "Accept: application/vnd.github+json" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            /repos/${{ github.repository }}/issues/comments/$COMMENT_ID/pin
